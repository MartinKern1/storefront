{% block element_product_listing %}
    {# @var result \Shopware\Core\Framework\DataAbstractionLayer\Search\EntitySearchResult #}
    {% set searchResult = element.data.listing %}
    {% set listingColumns = 'col-sm-6 col-lg-4 col-xl-3' %}

    {% if section and section.type == 'sidebar' %}
        {% set listingColumns = 'col-sm-6 col-lg-6 col-xl-4' %}
    {% endif %}

    {% set currentPage = ((searchResult.criteria.offset + 1) / searchResult.criteria.limit )|round(0, 'ceil') %}
    {% set config = { page: currentPage }|json_encode %}

    <div class="cms-element-{{ element.type }}" data-pagination="true" data-pagination-options='{{ config }}'>
        <div class="product-listing-top-bar">
            {% block element_product_listing_pagination_nav_top %}
                {% sw_include '@Storefront/component/pagination.html.twig' with { criteria: searchResult.criteria } %}
            {% endblock %}

            {% block element_product_listing_sorting %}
                {% sw_include '@Storefront/component/sorting.html.twig' with { current: searchResult.sorting, sortings: searchResult.sortings } %}
            {% endblock %}
        </div>

        {% block element_product_listing_row %}
            <div class="row cms-listing-row js-listing-wrapper">
                {% block element_product_listing_col %}
                    {% for product in searchResult %}
                        <div class="cms-listing-col {{ listingColumns }}">
                            {% block element_product_listing_box %}
                                {% sw_include '@Storefront/component/product/card/box.html.twig' with {
                                    'layout': element.translated.config.boxLayout.value,
                                    'displayMode': element.translated.config.displayMode.value
                                } %}
                            {% endblock %}
                        </div>
                    {% endfor %}
                {% endblock %}
            </div>
        {% endblock %}

        {% block element_product_listing_pagination_nav_bottom %}
            {% sw_include '@Storefront/component/pagination.html.twig' with { criteria: searchResult.criteria } %}
        {% endblock %}
    </div>
{% endblock %}
